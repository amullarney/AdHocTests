-- BP 7.1.6 content: Package syschar: 3 persistence-version: 7.1.6

INSERT INTO EP_PKG
	VALUES ("6a4a82e9-5119-463b-b210-5e00c3ece052",
	"00000000-0000-0000-0000-000000000000",
	"846e9e70-104d-4678-8694-b2e3922e335a",
	'TestFunctions',
	'',
	0);
INSERT INTO GD_MD
	VALUES ("c5df5776-d86a-449a-b794-4d7eb5cea450",
	112,
	"6a4a82e9-5119-463b-b210-5e00c3ece052",
	108,
	0,
	0,
	1,
	1,
	1,
	12,
	1,
	0,
	0,
	0,
	0,
	0,
	'4.1.17',
	'Tests::Components::Test::TestFunctions');
INSERT INTO DIM_DIA
	VALUES ("c5df5776-d86a-449a-b794-4d7eb5cea450",
	'',
	1.000000,
	0.000000,
	0.000000,
	"00000000-0000-0000-0000-000000000000");
INSERT INTO S_SYNC
	VALUES ("11a44be8-a1a3-4c0b-9871-0a634b5e8920",
	"00000000-0000-0000-0000-000000000000",
	'TestEventPending',
	'A test to show that an event which caused a transition into a state is misleadingly 
displayed as pending in Verifier''s Session Explorer.
Set a breakpoint in state "looking" of observation class before executing this function.
View the instance in Session Explorer: event "peek" is shown as pending.',
	'create object instance glance of observation;
generate observation1:peek() to glance;',
	"ba5eda7a-def5-0000-0000-000000000000",
	1,
	'',
	0);
INSERT INTO PE_PE
	VALUES ("11a44be8-a1a3-4c0b-9871-0a634b5e8920",
	1,
	"6a4a82e9-5119-463b-b210-5e00c3ece052",
	"00000000-0000-0000-0000-000000000000",
	1);
INSERT INTO S_SYNC
	VALUES ("78879f39-c2a4-467e-8b01-dea55e9d8ab9",
	"00000000-0000-0000-0000-000000000000",
	'PipeTest',
	'',
	'create object instance pipe1 of pipe;
create object instance pipe2 of pipe;
relate pipe2 to pipe1 across R2.''connects to'';
pipe2.empty = true;
create object instance pipe3 of pipe;
relate pipe3 to pipe1 across R2.''connects to'';
create object instance pipe4 of pipe;
relate pipe4 to pipe1 across R2.''connects to'';
create object instance pipe5 of pipe;
relate pipe5 to pipe1 across R2.''connects to'';

select many segments related by pipe1->pipe[R2.''attaches to'']
 where ( not selected.empty  );
for each segment in segments
	LOG::LogSuccess( message:"found one" );
end for;
',
	"ba5eda7a-def5-0000-0000-000000000000",
	1,
	'',
	0);
INSERT INTO PE_PE
	VALUES ("78879f39-c2a4-467e-8b01-dea55e9d8ab9",
	1,
	"6a4a82e9-5119-463b-b210-5e00c3ece052",
	"00000000-0000-0000-0000-000000000000",
	1);
INSERT INTO S_SYNC
	VALUES ("3477824f-86bc-4c06-a565-396bf833be72",
	"00000000-0000-0000-0000-000000000000",
	'SetAddition',
	'',
	'create object instance t1 of thingmajig;
t1.sequenceNumber = 1;
create object instance t2 of thingmajig;
t2.sequenceNumber = 2;
create object instance t3 of thingmajig;
t3.sequenceNumber = 3;
create object instance t4 of thingmajig;
t4.sequenceNumber = 4;
create object instance t5 of thingmajig;
t5.sequenceNumber = 5;

select many items from instances of thingmajig;
select many entities from instances of thingmajig;

all = items + entities;
for each t in all
  LOG::LogInfo( message:"SetAddition - expect 5 entities" );
  LOG::LogInteger( message:t.sequenceNumber );
end for;',
	"ba5eda7a-def5-0000-0000-000000000000",
	1,
	'',
	0);
INSERT INTO PE_PE
	VALUES ("3477824f-86bc-4c06-a565-396bf833be72",
	1,
	"6a4a82e9-5119-463b-b210-5e00c3ece052",
	"00000000-0000-0000-0000-000000000000",
	1);
INSERT INTO S_SYNC
	VALUES ("69d7ee07-e57d-488b-921d-a34954f3c9f5",
	"00000000-0000-0000-0000-000000000000",
	'Selections',
	'',
	'create object instance e1 of employee;
e1.name = "Jack";
e1.role = "technician";
create object instance e2 of employee;
e2.name = "Jill";
e2.role = "supervisor";

create object instance p1 of payment;
relate p1 to e1 across R3.''is for'';
create object instance p2 of payment;
relate p2 to e2 across R3.''is for'';

// Jack''s pay
create object instance element1 of payElement;
element1.amount = 400;
element1.name = "salary";
element1.withholding = 90;
relate element1 to p1 across R4.''contributes to'';
create object instance element2 of payElement;
relate element2 to p1 across R4.''contributes to'';
create object instance element3 of payElement;
element3.amount = 50;
element3.name = "bonus";
relate element3 to p1 across R4.''contributes to'';

// Jill''s pay
create object instance element4 of payElement;
relate element4 to p2 across R4.''contributes to'';
create object instance element5 of payElement;
relate element5 to p2 across R4.''contributes to'';

create object instance payroll of Payroll;
payroll.month = "June";
select many elements from instances of payElement;
for each element in elements
  relate element to payroll across R5.''is part of'';
end for;
',
	"ba5eda7a-def5-0000-0000-000000000000",
	1,
	'',
	0);
INSERT INTO PE_PE
	VALUES ("69d7ee07-e57d-488b-921d-a34954f3c9f5",
	1,
	"6a4a82e9-5119-463b-b210-5e00c3ece052",
	"00000000-0000-0000-0000-000000000000",
	1);
INSERT INTO S_SYNC
	VALUES ("0fc6c5a7-d306-40e5-a30c-a8e0e6ab5da8",
	"00000000-0000-0000-0000-000000000000",
	'Testtrigger',
	'',
	'create object instance obs1 of observation;
create object instance trigger1 of trigger;
relate obs1 to  trigger1 across R10.''waits for'';
unrelate obs1 from trigger1 across R10.''waits for'';
select any obs1 related by trigger1->observation[R10.''initiates''];
if ( empty obs1 )
  delete object instance trigger1;
end if;',
	"ba5eda7a-def5-0000-0000-000000000000",
	1,
	'',
	0);
INSERT INTO PE_PE
	VALUES ("0fc6c5a7-d306-40e5-a30c-a8e0e6ab5da8",
	1,
	"6a4a82e9-5119-463b-b210-5e00c3ece052",
	"00000000-0000-0000-0000-000000000000",
	1);
INSERT INTO S_SYNC
	VALUES ("1f8e0ab5-2dd3-4153-bd5e-4145b872766e",
	"00000000-0000-0000-0000-000000000000",
	'PersistTest',
	'',
	'LOG::LogInfo( message:"Trying to load from stdin" );
SQL::load();

select any employee from instances of employee;
if ( empty employee )
  LOG::LogInfo( message:"creating instances programatically" );
    ::Selections();
    ::AssocTest();
    ::RouteTest();
    ::SuperTest();
    ::OwnerTest();
  LOG::LogInfo( message:"created..." );
  Route::Report();
  Payroll::Report();
  Aircraft::Report();
  coOwner::Report();
  Driver::Report();
  TheParent::Report();
else
  LOG::LogInfo( message:"Sucessfully loaded persisted data - exploring what we got:" );
  Route::Report();
  Payroll::Report();
  Aircraft::Report();
  coOwner::Report();
  Driver::Report();
  TheParent::Report();
end if;

LOG::LogInfo( message:"persisting..." );
SQL::serialize_file( file:"persisted.sql" );

LOG::LogInfo( message:"done" );

control stop;',
	"ba5eda7a-def5-0000-0000-000000000000",
	1,
	'',
	0);
INSERT INTO PE_PE
	VALUES ("1f8e0ab5-2dd3-4153-bd5e-4145b872766e",
	1,
	"6a4a82e9-5119-463b-b210-5e00c3ece052",
	"00000000-0000-0000-0000-000000000000",
	1);
INSERT INTO S_SYNC
	VALUES ("dbaf23b3-8cc2-433f-a98f-9c2865c0d5cd",
	"00000000-0000-0000-0000-000000000000",
	'AssocTest',
	'',
	'create object instance suv of Car;
create object instance man of Driver;
create object instance reg of Registration;
reg.Fee = 50;
relate man to suv across R6.''owns'' using reg;
create object instance cdl of License;
create object instance exp of expiration;
exp.endDate = 2023;
relate cdl to man across R7.''licenses'' using exp;',
	"ba5eda7a-def5-0000-0000-000000000000",
	1,
	'',
	0);
INSERT INTO PE_PE
	VALUES ("dbaf23b3-8cc2-433f-a98f-9c2865c0d5cd",
	1,
	"6a4a82e9-5119-463b-b210-5e00c3ece052",
	"00000000-0000-0000-0000-000000000000",
	1);
INSERT INTO S_SYNC
	VALUES ("d23830cd-b660-4ef5-931c-7e727fd1af9f",
	"00000000-0000-0000-0000-000000000000",
	'RouteTest',
	'',
	'create object instance Dublin of City;
Dublin.name = "dublin";
create object instance Limerick of City;
Limerick.name = "limerick";
create object instance Belfast of City;
Belfast.name = "belfast";
create object instance Wicklow of City;
Wicklow.name = "wicklow";
create object instance M1 of Route;
M1.distance = 90;
relate Belfast to Dublin across R11.''has routes to'' using M1;
create object instance M7 of Route;
M7.distance = 110;
relate Limerick to Dublin across R11.''has routes to'' using M7;
create object instance M2 of Route;
M2.distance = 30;
relate Wicklow to Dublin across R11.''has routes from'' using M2;
create object instance Byway of Route;
relate Belfast to Limerick across R11.''has routes from'' using Byway;',
	"ba5eda7a-def5-0000-0000-000000000000",
	1,
	'',
	0);
INSERT INTO PE_PE
	VALUES ("d23830cd-b660-4ef5-931c-7e727fd1af9f",
	1,
	"6a4a82e9-5119-463b-b210-5e00c3ece052",
	"00000000-0000-0000-0000-000000000000",
	1);
INSERT INTO S_SYNC
	VALUES ("9412d2d4-9488-4981-b09d-3e3e4e39b42c",
	"00000000-0000-0000-0000-000000000000",
	'SuperTest',
	'',
	'create object instance ac of Aircraft;
ac.number = "EI-123";
create object instance jet of Jet;
jet.make = "Airbus";
jet.wingspan = 120;
relate jet to ac across R12;

create object instance ac of Aircraft;
ac.number = "1055W";
create object instance glider of Glider;
glider.wingspan = 15;
relate glider to ac across R12;

create object instance parent of TheParent;
parent.Name = "LivingCreature";
create object instance child of TheChild;
child.Name = "Animal";
relate child to parent across R13;

create object instance parent of TheParent;
parent.Name = "LivingCreature";
create object instance child of TheChild;
child.Name = "Man";
relate child to parent across R13;

create object instance isaA of classA;
create object instance isaB of classB;
relate isaB to isaA across R14.''is a'';',
	"ba5eda7a-def5-0000-0000-000000000000",
	1,
	'',
	0);
INSERT INTO PE_PE
	VALUES ("9412d2d4-9488-4981-b09d-3e3e4e39b42c",
	1,
	"6a4a82e9-5119-463b-b210-5e00c3ece052",
	"00000000-0000-0000-0000-000000000000",
	1);
INSERT INTO S_SYNC
	VALUES ("ef378a65-6197-4acb-844a-29cd3fe66a53",
	"00000000-0000-0000-0000-000000000000",
	'OwnerTest',
	'',
	'create object instance c of coOwner;
create object instance t of thingmajig;
t.sequenceNumber = 1001;
relate t to c across R8.''are shared by'';
create object instance t of thingmajig;
t.sequenceNumber = 1002;
relate t to c across R8.''are shared by'';',
	"ba5eda7a-def5-0000-0000-000000000000",
	1,
	'',
	0);
INSERT INTO PE_PE
	VALUES ("ef378a65-6197-4acb-844a-29cd3fe66a53",
	1,
	"6a4a82e9-5119-463b-b210-5e00c3ece052",
	"00000000-0000-0000-0000-000000000000",
	1);
INSERT INTO PE_PE
	VALUES ("6a4a82e9-5119-463b-b210-5e00c3ece052",
	1,
	"00000000-0000-0000-0000-000000000000",
	"7bf54281-dcf1-4f23-91f6-05c5083cfd18",
	7);
INSERT INTO C_C_PROXY
	VALUES ("7bf54281-dcf1-4f23-91f6-05c5083cfd18",
	"00000000-0000-0000-0000-000000000000",
	"00000000-0000-0000-0000-000000000000",
	'Test',
	'Two test functions exercise one-shot and recurring timers.

When run deterministically - with simulated time ( no choice but to do so ) the action is as expected.
Log messages stream continuously to the console.

When run deterministically is unchecked - simulated time is still checked - nothing happens. (And restart does not alter this).

When simulated time is unchecked( and deterministically unchecked ) log messages arrive separated in real time - as expected. 
( This requires restart if simulated time has been run ).',
	0,
	"00000000-0000-0000-0000-000000000000",
	0,
	'',
	'../Test.xtuml');
INSERT INTO S_SYS_PROXY
	VALUES ("846e9e70-104d-4678-8694-b2e3922e335a",
	'Tests',
	1,
	'../../../Tests.xtuml');
